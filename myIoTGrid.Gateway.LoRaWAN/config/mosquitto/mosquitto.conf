# Mosquitto MQTT Broker Configuration
# myIoTGrid.Gateway.LoRaWAN
# Dual-Port: 1883 (intern), 1884 (extern)
# Stand: 10.12.2025

# ============================================
# General Settings
# ============================================

# Persistence
persistence true
persistence_location /mosquitto/data/

# Log output
log_dest stdout
log_type error
log_type warning
log_type notice
log_type information

# Log timestamp format
log_timestamp true
log_timestamp_format %Y-%m-%dT%H:%M:%S

# Connection messages
connection_messages true

# ============================================
# Internal Listener (Port 1883)
# ChirpStack <-> Gateway Bridge <-> myIoTGrid Bridge
# ============================================

listener 1883
protocol mqtt

# Anonymous access for internal communication
allow_anonymous true

# Max connections (0 = unlimited)
max_connections 100

# ============================================
# External Listener (Port 1884)
# myIoTGrid Bridge -> myIoTGrid.Hub
# ============================================

listener 1884
protocol mqtt

# Anonymous access for demo (production: enable auth!)
allow_anonymous true

# Max connections
max_connections 50

# ============================================
# System Topics
# ============================================

# Enable $SYS topics
sys_interval 10

# ============================================
# Security (Demo Mode - No Auth)
# ============================================

# For production, enable password file:
# password_file /mosquitto/config/passwords.txt
# acl_file /mosquitto/config/acl.conf

# ============================================
# Message Settings
# ============================================

# Max inflight messages
max_inflight_messages 20

# Max queued messages
max_queued_messages 1000

# Message size limit (256KB should be enough for sensor data)
message_size_limit 262144

# ============================================
# Keep Alive
# ============================================

# Max keepalive (seconds)
max_keepalive 300
