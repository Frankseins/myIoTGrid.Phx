{
  "info": {
    "_postman_id": "myiotgrid-readings-api",
    "name": "myIoTGrid Cloud API - Readings",
    "description": "Vollständige API-Endpunkte für Sensor-Messwerte (Readings) in der myIoTGrid Cloud.\n\n## Schnellstart\n\n1. Setze die Variable `baseUrl` auf deine API-URL\n2. Hole dir eine gültige `nodeId` aus `/api/nodes`\n3. Hole dir eine gültige `assignmentId` aus `/api/nodes/{nodeId}/assignments`\n\n## Endpoints\n\n- GET /api/readings - Gefilterte Readings\n- GET /api/readings/node/{nodeId} - Readings eines Nodes\n- GET /api/readings/latest/{nodeId} - Letzte Readings\n- GET /api/readings/chart - Aggregierte Chart-Daten\n- POST /api/readings - Neues Reading erstellen\n- POST /api/readings/batch - Batch-Upload\n- DELETE /api/readings/range - Readings löschen",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "baseUrl",
      "value": "https://api.myiotgrid.cloud",
      "type": "string",
      "description": "Base URL der API (z.B. http://localhost:5000 oder https://api.myiotgrid.cloud)"
    },
    {
      "key": "nodeId",
      "value": "00000000-0000-0000-0000-000000000000",
      "type": "string",
      "description": "UUID eines Nodes - hole dir diese aus GET /api/nodes"
    },
    {
      "key": "assignmentId",
      "value": "00000000-0000-0000-0000-000000000000",
      "type": "string",
      "description": "UUID einer Sensor-Zuweisung - hole dir diese aus GET /api/nodes/{nodeId}/assignments"
    }
  ],
  "item": [
    {
      "name": "01 - Setup",
      "description": "Endpunkte zum Einrichten der Test-Umgebung",
      "item": [
        {
          "name": "Get All Nodes",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var jsonData = pm.response.json();",
                  "",
                  "if (jsonData && jsonData.length > 0) {",
                  "    pm.collectionVariables.set('nodeId', jsonData[0].id);",
                  "    console.log('nodeId gesetzt auf: ' + jsonData[0].id);",
                  "}",
                  "",
                  "pm.test('Nodes gefunden', function () {",
                  "    pm.expect(jsonData).to.be.an('array');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/nodes",
              "host": ["{{baseUrl}}"],
              "path": ["api", "nodes"]
            },
            "description": "Holt alle Nodes und setzt automatisch die `nodeId` Variable auf den ersten Node."
          },
          "response": []
        },
        {
          "name": "Get Node Assignments",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var jsonData = pm.response.json();",
                  "",
                  "if (jsonData && jsonData.length > 0) {",
                  "    pm.collectionVariables.set('assignmentId', jsonData[0].id);",
                  "    console.log('assignmentId gesetzt auf: ' + jsonData[0].id);",
                  "}",
                  "",
                  "pm.test('Assignments gefunden', function () {",
                  "    pm.expect(jsonData).to.be.an('array');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/nodesensorassignments/node/{{nodeId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "nodesensorassignments", "node", "{{nodeId}}"]
            },
            "description": "Holt alle Sensor-Zuweisungen für einen Node und setzt automatisch die `assignmentId` Variable."
          },
          "response": []
        }
      ]
    },
    {
      "name": "02 - Readings abrufen",
      "description": "Endpunkte zum Lesen von Messwerten",
      "item": [
        {
          "name": "Get Readings by Node",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Response ist Array', function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.be.an('array');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/readings/node/{{nodeId}}?pageSize=50",
              "host": ["{{baseUrl}}"],
              "path": ["api", "readings", "node", "{{nodeId}}"],
              "query": [
                {
                  "key": "measurementType",
                  "value": "temperature",
                  "description": "Filter nach Messwerttyp (z.B. temperature, humidity, co2)",
                  "disabled": true
                },
                {
                  "key": "assignmentId",
                  "value": "{{assignmentId}}",
                  "description": "Filter nach Sensor-Zuweisung",
                  "disabled": true
                },
                {
                  "key": "from",
                  "value": "2025-12-01T00:00:00Z",
                  "description": "Start-Zeitpunkt (ISO 8601)",
                  "disabled": true
                },
                {
                  "key": "to",
                  "value": "2025-12-31T23:59:59Z",
                  "description": "End-Zeitpunkt (ISO 8601)",
                  "disabled": true
                },
                {
                  "key": "page",
                  "value": "1",
                  "description": "Seitennummer",
                  "disabled": true
                },
                {
                  "key": "pageSize",
                  "value": "50",
                  "description": "Einträge pro Seite"
                }
              ]
            },
            "description": "Holt alle Readings für einen Node. Aktiviere die Query-Parameter zum Filtern."
          },
          "response": [
            {
              "name": "Success Response",
              "originalRequest": {
                "method": "GET",
                "url": {
                  "raw": "{{baseUrl}}/api/readings/node/{{nodeId}}?measurementType=temperature&pageSize=50"
                }
              },
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "json",
              "body": "[\n  {\n    \"id\": 12345,\n    \"tenantId\": \"00000000-0000-0000-0000-000000000001\",\n    \"nodeId\": \"3fa85f64-5717-4562-b3fc-2c963f66afa6\",\n    \"nodeName\": \"Wohnzimmer Sensor\",\n    \"sensorCode\": \"BME280\",\n    \"sensorName\": \"BME280 Umweltsensor\",\n    \"measurementType\": \"temperature\",\n    \"displayName\": \"Temperatur\",\n    \"rawValue\": 21.45,\n    \"value\": 21.5,\n    \"unit\": \"°C\",\n    \"timestamp\": \"2025-12-12T10:30:00Z\"\n  }\n]"
            }
          ]
        },
        {
          "name": "Get Readings by Node - Temperature only",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/readings/node/{{nodeId}}?measurementType=temperature&pageSize=100",
              "host": ["{{baseUrl}}"],
              "path": ["api", "readings", "node", "{{nodeId}}"],
              "query": [
                {
                  "key": "measurementType",
                  "value": "temperature"
                },
                {
                  "key": "pageSize",
                  "value": "100"
                }
              ]
            },
            "description": "Holt nur Temperatur-Readings eines Nodes."
          },
          "response": []
        },
        {
          "name": "Get Readings by Node - Date Range",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/readings/node/{{nodeId}}?from=2025-12-01T00:00:00Z&to=2025-12-12T23:59:59Z&pageSize=100",
              "host": ["{{baseUrl}}"],
              "path": ["api", "readings", "node", "{{nodeId}}"],
              "query": [
                {
                  "key": "from",
                  "value": "2025-12-01T00:00:00Z"
                },
                {
                  "key": "to",
                  "value": "2025-12-12T23:59:59Z"
                },
                {
                  "key": "pageSize",
                  "value": "100"
                }
              ]
            },
            "description": "Holt Readings eines Nodes in einem Zeitraum."
          },
          "response": []
        },
        {
          "name": "Get Latest Readings by Node",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Response ist Array', function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.be.an('array');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/readings/latest/{{nodeId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "readings", "latest", "{{nodeId}}"]
            },
            "description": "Holt die neuesten Readings pro Sensor und Messwerttyp. Ideal für Dashboards."
          },
          "response": [
            {
              "name": "Success Response",
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "json",
              "body": "[\n  {\n    \"id\": 12345,\n    \"nodeId\": \"3fa85f64-5717-4562-b3fc-2c963f66afa6\",\n    \"nodeName\": \"Wohnzimmer Sensor\",\n    \"sensorCode\": \"BME280\",\n    \"measurementType\": \"temperature\",\n    \"displayName\": \"Temperatur\",\n    \"value\": 21.5,\n    \"unit\": \"°C\",\n    \"timestamp\": \"2025-12-12T10:30:00Z\"\n  },\n  {\n    \"id\": 12346,\n    \"nodeId\": \"3fa85f64-5717-4562-b3fc-2c963f66afa6\",\n    \"nodeName\": \"Wohnzimmer Sensor\",\n    \"sensorCode\": \"BME280\",\n    \"measurementType\": \"humidity\",\n    \"displayName\": \"Luftfeuchtigkeit\",\n    \"value\": 45.2,\n    \"unit\": \"%\",\n    \"timestamp\": \"2025-12-12T10:30:00Z\"\n  }\n]"
            }
          ]
        },
        {
          "name": "Get All Latest Readings",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/readings/latest",
              "host": ["{{baseUrl}}"],
              "path": ["api", "readings", "latest"]
            },
            "description": "Holt die neuesten Readings aller Nodes."
          },
          "response": []
        },
        {
          "name": "Get Filtered Readings (general)",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/readings?measurementType=temperature&page=1&pageSize=50",
              "host": ["{{baseUrl}}"],
              "path": ["api", "readings"],
              "query": [
                {
                  "key": "nodeId",
                  "value": "{{nodeId}}",
                  "description": "Filter nach Node UUID",
                  "disabled": true
                },
                {
                  "key": "nodeIdentifier",
                  "value": "ESP32-WROOM-001",
                  "description": "Filter nach Node Serial Number",
                  "disabled": true
                },
                {
                  "key": "hubId",
                  "value": "",
                  "description": "Filter nach Hub UUID",
                  "disabled": true
                },
                {
                  "key": "assignmentId",
                  "value": "{{assignmentId}}",
                  "description": "Filter nach Sensor-Zuweisung",
                  "disabled": true
                },
                {
                  "key": "measurementType",
                  "value": "temperature",
                  "description": "Filter nach Messwerttyp"
                },
                {
                  "key": "from",
                  "value": "2025-12-01T00:00:00Z",
                  "description": "Start-Zeitpunkt",
                  "disabled": true
                },
                {
                  "key": "to",
                  "value": "2025-12-31T23:59:59Z",
                  "description": "End-Zeitpunkt",
                  "disabled": true
                },
                {
                  "key": "isSyncedToCloud",
                  "value": "true",
                  "description": "Filter nach Sync-Status",
                  "disabled": true
                },
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "pageSize",
                  "value": "50"
                }
              ]
            },
            "description": "Allgemeiner Filter-Endpunkt mit allen Optionen. Aktiviere die gewünschten Query-Parameter."
          },
          "response": []
        },
        {
          "name": "Get Paged Readings (with sorting)",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/readings/paged?page=1&size=20&sort=timestamp,desc",
              "host": ["{{baseUrl}}"],
              "path": ["api", "readings", "paged"],
              "query": [
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "size",
                  "value": "20"
                },
                {
                  "key": "sort",
                  "value": "timestamp,desc",
                  "description": "Sortierung: field,direction (asc/desc)"
                },
                {
                  "key": "search",
                  "value": "Wohnzimmer",
                  "description": "Volltextsuche",
                  "disabled": true
                }
              ]
            },
            "description": "Server-Side Paging mit Sortierung und Suche."
          },
          "response": []
        },
        {
          "name": "Get Reading by ID",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/readings/12345",
              "host": ["{{baseUrl}}"],
              "path": ["api", "readings", "12345"]
            },
            "description": "Holt ein einzelnes Reading per ID."
          },
          "response": []
        }
      ]
    },
    {
      "name": "03 - Chart-Daten",
      "description": "Endpunkte für Chart-Visualisierungen",
      "item": [
        {
          "name": "Get Chart Data - Last 24h",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 200 or 404', function () {",
                  "    pm.expect(pm.response.code).to.be.oneOf([200, 404]);",
                  "});",
                  "",
                  "if (pm.response.code === 200) {",
                  "    pm.test('Response hat dataPoints', function () {",
                  "        var jsonData = pm.response.json();",
                  "        pm.expect(jsonData).to.have.property('dataPoints');",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/readings/chart/{{nodeId}}/{{assignmentId}}/temperature?interval=OneDay",
              "host": ["{{baseUrl}}"],
              "path": ["api", "readings", "chart", "{{nodeId}}", "{{assignmentId}}", "temperature"],
              "query": [
                {
                  "key": "interval",
                  "value": "OneDay",
                  "description": "OneHour, SixHours, TwelveHours, OneDay, OneWeek, OneMonth, ThreeMonths, OneYear"
                }
              ]
            },
            "description": "Aggregierte Chart-Daten mit Statistiken und Trend."
          },
          "response": [
            {
              "name": "Success Response",
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "json",
              "body": "{\n  \"nodeId\": \"3fa85f64-5717-4562-b3fc-2c963f66afa6\",\n  \"nodeName\": \"Wohnzimmer Sensor\",\n  \"measurementType\": \"temperature\",\n  \"displayName\": \"Temperatur\",\n  \"unit\": \"°C\",\n  \"interval\": \"OneDay\",\n  \"dataPoints\": [\n    {\n      \"timestamp\": \"2025-12-11T10:30:00Z\",\n      \"value\": 20.5,\n      \"min\": 20.1,\n      \"max\": 20.9,\n      \"count\": 4\n    }\n  ],\n  \"statistics\": {\n    \"min\": 18.5,\n    \"max\": 24.2,\n    \"avg\": 21.3,\n    \"count\": 96\n  },\n  \"trend\": {\n    \"direction\": \"up\",\n    \"changePercent\": 2.5,\n    \"changeAbsolute\": 0.5\n  }\n}"
            }
          ]
        },
        {
          "name": "Get Chart Data - Last Hour",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/readings/chart/{{nodeId}}/{{assignmentId}}/temperature?interval=OneHour",
              "host": ["{{baseUrl}}"],
              "path": ["api", "readings", "chart", "{{nodeId}}", "{{assignmentId}}", "temperature"],
              "query": [
                {
                  "key": "interval",
                  "value": "OneHour"
                }
              ]
            },
            "description": "Chart-Daten der letzten Stunde (Aggregation pro Minute)."
          },
          "response": []
        },
        {
          "name": "Get Chart Data - Last Week",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/readings/chart/{{nodeId}}/{{assignmentId}}/temperature?interval=OneWeek",
              "host": ["{{baseUrl}}"],
              "path": ["api", "readings", "chart", "{{nodeId}}", "{{assignmentId}}", "temperature"],
              "query": [
                {
                  "key": "interval",
                  "value": "OneWeek"
                }
              ]
            },
            "description": "Chart-Daten der letzten 7 Tage (Aggregation pro Stunde)."
          },
          "response": []
        },
        {
          "name": "Get Readings List (paginated table)",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/readings/list/{{nodeId}}/{{assignmentId}}/temperature?page=1&pageSize=20",
              "host": ["{{baseUrl}}"],
              "path": ["api", "readings", "list", "{{nodeId}}", "{{assignmentId}}", "temperature"],
              "query": [
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "pageSize",
                  "value": "20"
                },
                {
                  "key": "from",
                  "value": "2025-12-01T00:00:00Z",
                  "disabled": true
                },
                {
                  "key": "to",
                  "value": "2025-12-31T23:59:59Z",
                  "disabled": true
                }
              ]
            },
            "description": "Paginierte Liste für Tabellen-Ansicht."
          },
          "response": []
        }
      ]
    },
    {
      "name": "04 - Export",
      "description": "CSV-Export Endpunkte",
      "item": [
        {
          "name": "Export CSV",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "text/csv"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/readings/list/{{nodeId}}/{{assignmentId}}/temperature/csv",
              "host": ["{{baseUrl}}"],
              "path": ["api", "readings", "list", "{{nodeId}}", "{{assignmentId}}", "temperature", "csv"],
              "query": [
                {
                  "key": "from",
                  "value": "2025-12-01T00:00:00Z",
                  "disabled": true
                },
                {
                  "key": "to",
                  "value": "2025-12-31T23:59:59Z",
                  "disabled": true
                }
              ]
            },
            "description": "Exportiert Readings als CSV-Datei. Kann direkt im Browser geöffnet oder in Excel importiert werden."
          },
          "response": [
            {
              "name": "CSV Response",
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "text",
              "header": [
                {
                  "key": "Content-Type",
                  "value": "text/csv"
                },
                {
                  "key": "Content-Disposition",
                  "value": "attachment; filename=readings_temperature_20251212_103000.csv"
                }
              ],
              "body": "Id,Timestamp,RawValue,Value,Unit\n12345,2025-12-12T10:30:00Z,21.45,21.5,°C\n12344,2025-12-12T10:25:00Z,21.32,21.3,°C"
            }
          ]
        },
        {
          "name": "Export CSV - Date Range",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "text/csv"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/readings/list/{{nodeId}}/{{assignmentId}}/temperature/csv?from=2025-12-01&to=2025-12-12",
              "host": ["{{baseUrl}}"],
              "path": ["api", "readings", "list", "{{nodeId}}", "{{assignmentId}}", "temperature", "csv"],
              "query": [
                {
                  "key": "from",
                  "value": "2025-12-01"
                },
                {
                  "key": "to",
                  "value": "2025-12-12"
                }
              ]
            },
            "description": "CSV-Export für einen bestimmten Zeitraum."
          },
          "response": []
        }
      ]
    },
    {
      "name": "05 - Readings erstellen",
      "description": "Endpunkte zum Erstellen von Messwerten (typischerweise von ESP32 Sensoren)",
      "item": [
        {
          "name": "Create Reading (from sensor)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 201 Created', function () {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test('Response hat id', function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('id');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"deviceId\": \"ESP32-WROOM-001\",\n  \"type\": \"temperature\",\n  \"value\": 21.5,\n  \"unit\": \"°C\",\n  \"endpointId\": 1\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/readings",
              "host": ["{{baseUrl}}"],
              "path": ["api", "readings"]
            },
            "description": "Erstellt ein neues Reading. Dieses Format wird von ESP32 Sensoren verwendet.\n\n**Body:**\n- `deviceId` (required): Node Serial Number\n- `type` (required): Messwerttyp (z.B. \"temperature\")\n- `value` (required): Messwert\n- `unit` (optional): Einheit\n- `endpointId` (optional): Sensor-Endpoint für Multi-Sensor-Nodes"
          },
          "response": [
            {
              "name": "Success Response",
              "status": "Created",
              "code": 201,
              "_postman_previewlanguage": "json",
              "body": "{\n  \"id\": 12346,\n  \"nodeId\": \"3fa85f64-5717-4562-b3fc-2c963f66afa6\",\n  \"nodeName\": \"Wohnzimmer Sensor\",\n  \"measurementType\": \"temperature\",\n  \"value\": 21.5,\n  \"unit\": \"°C\",\n  \"timestamp\": \"2025-12-12T10:30:00Z\"\n}"
            }
          ]
        },
        {
          "name": "Create Reading - Multiple Types",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"deviceId\": \"ESP32-WROOM-001\",\n  \"type\": \"humidity\",\n  \"value\": 45.2,\n  \"unit\": \"%\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/readings",
              "host": ["{{baseUrl}}"],
              "path": ["api", "readings"]
            },
            "description": "Beispiel für Luftfeuchtigkeit."
          },
          "response": []
        },
        {
          "name": "Batch Upload Readings",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Response hat successCount', function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('successCount');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"nodeId\": \"ESP32-WROOM-001\",\n  \"hubId\": null,\n  \"readings\": [\n    {\n      \"endpointId\": 1,\n      \"measurementType\": \"temperature\",\n      \"rawValue\": 21.5\n    },\n    {\n      \"endpointId\": 1,\n      \"measurementType\": \"humidity\",\n      \"rawValue\": 45.2\n    },\n    {\n      \"endpointId\": 2,\n      \"measurementType\": \"co2\",\n      \"rawValue\": 823\n    }\n  ],\n  \"timestamp\": null\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/readings/batch",
              "host": ["{{baseUrl}}"],
              "path": ["api", "readings", "batch"]
            },
            "description": "Lädt mehrere Readings in einem Request hoch. Ideal für Offline-Sync wenn der Sensor nach WiFi-Ausfall wieder online kommt.\n\n**Body:**\n- `nodeId` (required): Node Serial Number\n- `readings` (required): Array von Readings\n- `timestamp` (optional): Gemeinsamer Zeitstempel"
          },
          "response": [
            {
              "name": "Success Response",
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "json",
              "body": "{\n  \"successCount\": 3,\n  \"failedCount\": 0,\n  \"totalCount\": 3,\n  \"nodeId\": \"ESP32-WROOM-001\",\n  \"processedAt\": \"2025-12-12T10:30:05Z\",\n  \"errors\": null\n}"
            }
          ]
        }
      ]
    },
    {
      "name": "06 - Readings löschen",
      "description": "Endpunkte zum Löschen von Messwerten",
      "item": [
        {
          "name": "Delete Readings Range",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status 200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('Response hat deletedCount', function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('deletedCount');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"nodeId\": \"{{nodeId}}\",\n  \"from\": \"2025-12-01T00:00:00Z\",\n  \"to\": \"2025-12-05T23:59:59Z\",\n  \"assignmentId\": null,\n  \"measurementType\": null\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/readings/range",
              "host": ["{{baseUrl}}"],
              "path": ["api", "readings", "range"]
            },
            "description": "Löscht Readings in einem Zeitraum.\n\n**Body:**\n- `nodeId` (required): Node-ID\n- `from` (required): Start-Zeitpunkt\n- `to` (required): End-Zeitpunkt\n- `assignmentId` (optional): Nur bestimmte Sensor-Zuweisung\n- `measurementType` (optional): Nur bestimmter Messwerttyp"
          },
          "response": [
            {
              "name": "Success Response",
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "json",
              "body": "{\n  \"deletedCount\": 1542,\n  \"nodeId\": \"3fa85f64-5717-4562-b3fc-2c963f66afa6\",\n  \"from\": \"2025-12-01T00:00:00Z\",\n  \"to\": \"2025-12-05T23:59:59Z\",\n  \"assignmentId\": null,\n  \"measurementType\": null\n}"
            }
          ]
        },
        {
          "name": "Delete Readings - Temperature only",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"nodeId\": \"{{nodeId}}\",\n  \"from\": \"2025-12-01T00:00:00Z\",\n  \"to\": \"2025-12-05T23:59:59Z\",\n  \"measurementType\": \"temperature\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/readings/range",
              "host": ["{{baseUrl}}"],
              "path": ["api", "readings", "range"]
            },
            "description": "Löscht nur Temperatur-Readings in einem Zeitraum."
          },
          "response": []
        }
      ]
    }
  ]
}
